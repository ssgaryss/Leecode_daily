#include <iostream>
#include <vector>
#include <string>
#include <unordered_map>
using namespace std;

//正确但是超出时间限制
int longestAwesome_1(string s) {
	//对于一本超赞子字符串，其各个元素最多有一个的数量为奇数
	//由于s只包含数字字符所以我们只需要统计十个字符出现的数量times[10]奇偶性(1表示奇数，0表示偶数),index 0-9表示各个数字
	//任何一个子串s[i:j]的times[i:j] = times[0:i] ^ times[0:j] (因为奇偶性直接异或运算即可) 
	unordered_map<int, int> times; //<i, times[0:j]>后者是10位二进制数即[0,1024)
	times[0] = 0; //j为0即空字符串所有字符出现0次，times为全0
	int longest = 0;
	for (int i = 0; i < s.length() + 1; i++) {
		if (i < s.length()) {
			times[i + 1] = times[i] ^ (1 << (s[i] - '0'));
		}
		for (int j = 0; j < i; j++) {
			//对于一个二进制数n只有一个1，比如0001000000，它是2的指数，有n &（n-1）= 0
			//int temp = (times[j] ^ times[i]) & ((times[j] ^ times[i]) - 1);
			//int temp0 = (times[j] ^ times[i]);
			//int temp1 = ((times[j] ^ times[i]) - 1);
			//cout << i << " " << j << " " << temp << " " << temp0 << " " << temp1 << "\n";
			if (((times[j] ^ times[i]) & ((times[j] ^ times[i]) - 1)) == 0 || (times[j] ^ times[i]) == 0) {
				longest = longest < i - j ? i - j : longest;
			}
		}
	}
	return longest;
}

int longestAwesome_2(string s) {
	unordered_map<int, int> times;//<times[0:j], j>前者是10位二进制数即[0,1024)
	times[0] = -1;
	int longest = 0;
	int sequence = 0;
	for (int i = 0; i < s.length(); i++) {
		sequence ^= 1 << (s[i] - '0');
		if (times.count(sequence)) {
			longest = max(longest, i - times[sequence]);
		}
		else {
			times[sequence] = i;
		}
		for (int j = 0; j < 10; j++) {
			if (times.count(sequence ^ (1 << j))) {
				longest = max(longest, i - times[sequence ^ (1 << j)]);
			}
		}
	}
	return longest;
}

//再次优化
const int D = 10;
int longestAwesome(string s) {
	int n = s.size();
	vector<int> pos(1 << D, n); // n 表示没有找到异或前缀和
	pos[0] = -1; // pre[-1] = 0 表示前缀异或和为0的状态已经有了，它的区间末尾下标为-1
	int ans = 0, pre = 0;
	for (int i = 0; i < n; i++) {
		pre ^= 1 << (s[i] - '0');
		ans = max(ans, i - pos[pre]); // 偶数
		for (int d = 0; d < D; d++) ans = max(ans, i - pos[pre ^ (1 << d)]); // 奇数
		if (pos[pre] == n) pos[pre] = i; // 首次遇到值为 pre 的前缀异或和，记录其下标 i
	}
	return ans;
}

int main() {
	string s = "5130970804955893136973597460759983367627933216180609906159742676493296797309059949133071581384832040920799037956021185079445993721281515857528188483380104366268740088735173681974725716432190380158397822419971136768612270227101263560587120483109530649379297229946599373785383871452749610820461250468584086467985089041634875154986187329377927479067812284945047457329965406336936440060944253819723378223386847718307115109438199737913461654487542065300297627028000789088085013569417462281341880442313276051097435882016342864766915891279038283920070555380783876173902472146857504415386043994238851416755354664329122804953423356900532026699326087996393831794528494010798103035201350492353059173616492420162941209467603420491021335792343222709330625044759399656243759613243339471754316654058336632717600353813025032234483495824761186813858226624726393089816596555606765574456754172582271269373723050556132030097980774624481944383543444337762032926902247656920198641262595397134861361372858608726173479934701408178965601138658721422229883856520276934925847804535425918951037944014836810528257290036917967067185853672241041193831672289583380139217950978321106454532398362003711417819740740133882879622513786271575389293842104016503483684768528618912560573385523912585865006841977874852583957978570519048275686339700491636899094574534699752150725192738758714626247923014878167157048075340636262546512179442649981953624674816486115709824512383157245817158304247974657781774511501023327730299014996443923511748828621735083142956623346923354274611361272198179931652413727847975483057780059499706702390849600485020126484714601820597258651249849928387991823545781041742782472897977134930888494298175440827624829560149054182259372548657197581804317261097718019317989223678887555911807815845041189915972384514928497213603464597546406089311309638991555218909774085189681933251896383639772197280674170778424127553778835922920513992858793425944636148898209435558639372231231839268782028475191914229696600315031582176567266350194758102382991552677509040738328306926914599347848644939943418362116623917655933688817135705988873465828413527404329302513545528585894807873589987001502568680042205819330367858455977987889427366170882338134159375564441954691599783462887307835103726523331331070132572340838969923438795654283442333506261561661027526706980388139477080050094985784666929477967074309115492597246470206552693409670280521259629566015128707134369165168967912373990822462312311266067503521106507620709177250402953216620602040249868389553769794820180363395795448890709411632487747402323741454118532493412496993773359326765794521421391823341482742441808927083388314553896301049281689253686313053712326679859092571931093841635189809777011461316014698904268856336724871988494573359071025744206721818274267044239027038876603635184254826858179145627479626724606351671817509027192313034732873405844499359514000621464986939136430562271197451298509688191399509687184116070804840369281648388478684979141042142128306352148768120554072600091905288672476268828407418718632897629388544942371416760267411406612991580033213810893323635406060566634727553086775791181142058512788033782344355485245750550034982651270661669455020380281358846302108143282951950125985157257919366956241629211767755170261829308568892332213257177642506471456543243182517282506151783851684766263755751650945257147190662853046147126966029830780655764874487292247474373280260730476230005646443744517290756911852068340066249030135492821302483846869450414677371826477509481773630276127651603892640188671150684422122812205090012034695707912099766461953937727406567225787451665051074821762295181000552087392653460217307806694894282890159087924602560817688385238229220420057918802044700862232490602926635519690741462280096229770546240343868747025527988087369676145692838087807946210678931923815736854871291775902979320664872029185841229042635723849001184347002557707763411277985850152306216533842977468000922903243885417740046701147412416517563638800639279672869980836202074075658306614895577217368926961843825548471916246952385521552443993604933207047427393691711552563063507561157302157941240725305801771869977751163192161948531340494403464213259764894734206930993904997068842317179714384737846946166047960008438894292505215020427441255037274183501695187102092143372665144054202779446678985578969701233981593111768369059819610957478753411570287747943597330495232354380038597765336966665003905152422509136764643312582769201473674507965845824986129793235156919925955461109240298647124943217009180890877902786475693050212525034949465542830739986034206698039306985778695059959351144606500287656738458586115858158874524964394595824416893820146798876613805710916398717107613388587385171519238650015462026185701321194293161660770719070001709496492177287295828613350980284790969576998178744983166996587146614253502626224685982157207899085685871648829245914044954630121715165539381141974126256107639763039784764825821811179152600749572171040092516977588929282695798785285652218714328511531935063559124556903711338091119216191252222795980749805194144079468535163498238580325023465628669716435377575705258795915313002102848669696984561250685271077498661883030587125037827315180736267195359720183875200109771547729879319262298778766128438300710807121235902117218420113285017196112747683754476501441325448984545307544691427167667439860650760011946531704743218573694239950881197619347296290424223605247017471491808643882906933173473200879830322664029764073254571729570426625768779888858371580451617045694869735190989770093777457255364269266614803814756841031277877171799485421392246820529555865542106400761188313709586324320168669620017698931599637601345409553033852621009915295186140290007549927990297244307245295132986984092424584774553699247194450841016116846409072829164979516841168341947497553517759891709824997004441254558293264162096866852840682448012554655474822242139035523780721571885644508868643778449429533946331273035138466644701178096240630535571165485501309823629102523909133590284027321945274687477076454041352659453633137686056984637322514214605717800455317966563492123953976551952302340311970683287942137752858024878995680860211643234960996096831627827964981031756073353448260233180859027700233513084950692867500080641972656718373446594151389358194085394210714063583470236982617707829842496998253683825615685338564711045608384052855915352654551241173907693533308760975534548884657460241830273258805700080538609638736399824740691546093136207407679557251873555297507251074128936852903038938374743930680833977901357386537809317082650890230276730886726821166380977829991893396771227337129970207957969089591518771830758233993330860993918593540977018695082919789567020057724825892030749690180667808005403872374195294751656909441257769903873323046382139720385129462378480441963203766561174893543331534152629540049441275992110514436469302852281200426701536816336951282447822357403861391699458467032337270026517942795671399533156327999409729808187018500675249771466525365419056083419520663819872249153761934564342556406713096836771932921217456573721838173839144136575404741496940727954819915471843843162348599263206567119236778391482538842801689066845359444811852523638110830685897863391641711522618586944685918444517042956237427893981521105071074268064080398792173545784257753052265271478751374556117586842248380421201611325073766496414764824578019002516150681281643977985199209054623790101761367784385174932391530102029534446037293867511755146034300053893143670726467434275263643363468756402235457190413865208171598508063927807219973352235537766625736196816574020928265388752057282651995249631598535056117792667982683584534332363370433600196495440399712014412934001009108030351237191916769416194381727417692017538797544611580170465006447168191271164828942274130146684386745903038637700834661518677172093046281969492864877108281559995359303024084800678956833738869253402087522197718449027275767434289368068873217325656380406218067565745693761531752912689538817250674908233195793183028584566067213888824258744581270918691758101598438652355611155767018147240395410231592076915193257846245636837602956845525949371848432403951519871510648582617917635612246677867206713670482587692803815646053205522360168740851854903747292912466517462543281937985397706095499028732847304323350907963246284193895832141484351981125691243610987565044733141843443418233409223969918605512023958894226244026276889615829035786746879656779149049519733377610900268982057890193931042770727404494321930894931375547138581715871645922458893820952949243611330287216267045770810393375154665280114615292871732115605";
	int longest = longestAwesome(s);
	cout << longest;
}